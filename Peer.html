<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Peer-to-Peer Recognition</title>
  <link rel="stylesheet" href="style.css">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            display: flex;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .kudos-button {
            background-color: #fcd34d;
            color: #1e293b;
            padding: 10px 16px;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.3s;
            margin-bottom: 24px;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            border: none;
            font-size: 16px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .kudos-button:hover {
            background-color: #fbb034;
        }

        #give-kudos-modal {
            position: fixed;
            z-index: 10;
            inset: 0;
            overflow-y: auto;
            display: none;
        }

        #give-kudos-modal.show {
            display: flex;
        }

        .modal-overlay {
            position: fixed;
            inset: 0;
            background-color: rgba(0, 0, 0, 0.5);
            opacity: 0.75;
        }

        .modal-content {
            background-color: #ffffff;
            border-radius: 8px;
            text-align: left;
            overflow: hidden;
            transform: translateY(0);
            transition: transform 0.3s ease-out;
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.05);
            width: 100%;
            max-width: 500px;
            margin: auto;
        }

        #give-kudos-modal.show .modal-content {
            transform: translateY(0);
        }


        .modal-header {
            padding: 16px;
            border-bottom: 1px solid #e5e7eb;
        }

        .modal-header h2 {
            font-size: 1.25rem;
            font-weight: 600;
            color: #1f2937;
            margin: 0;
        }

        .modal-body {
            padding: 16px;
        }

        .modal-body form {
            display: flex;
            flex-direction: column;
            gap: 16px;
            margin-bottom: 0;
        }

        .modal-body form div {
            display: flex;
            flex-direction: column;
        }

        .modal-body form label {
            font-size: 0.875rem;
            font-weight: 500;
            color: #374151;
            margin-bottom: 6px;
            display: block;
        }

        .modal-body form select,
        .modal-body form textarea {
            padding: 10px;
            border-radius: 6px;
            border: 1px solid #d1d5db;
            font-size: 1rem;
            color: #4b5563;
            width: 100%;
            box-sizing: border-box;
            transition: border-color 0.2s ease;
        }

        .modal-body form select:focus,
        .modal-body form textarea:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.15);
        }


        .modal-body form textarea {
            resize: vertical;
            height: 120px;
        }

        .modal-footer {
            display: flex;
            justify-content: flex-end;
            padding: 16px;
            border-top: 1px solid #e5e7eb;
            gap: 12px;
        }

        .modal-footer button {
            padding: 10px 20px;
            border-radius: 6px;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: background-color 0.3s;
            border: none;
        }

        .modal-footer button.submit-button {
            background-color: #3b82f6;
            color: #ffffff;
        }

        .modal-footer button.submit-button:hover {
            background-color: #2563eb;
        }

        .modal-footer button.cancel-button {
            background-color: #ffffff;
            color: #374151;
            border: 1px solid #d1d5db;
        }

        .modal-footer button.cancel-button:hover {
            background-color: #f7f7f7;
        }

        #char-count {
            font-size: 0.75rem;
            color: #6b7280;
            text-align: right;
            margin-top: 4px;
        }

        .w-1\/4 {
            width: 25%;
        }

        .w-3\/4 {
            width: 75%;
        }

        .flex {
            display: flex;
        }

        .flex-col {
            flex-direction: column;
        }

        .lg\:flex-row {
            flex-direction: row;
        }

        .gap-6 {
            gap: 24px;
        }

        .rounded-lg {
            border-radius: 8px;
        }

        .shadow-md {
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1);
        }

        .p-4 {
            padding: 16px;
        }

        .md\:p-6 {
            padding: 24px;
        }

        .mb-6 {
            margin-bottom: 24px;
        }

        .text-lg {
            font-size: 1.125rem;
            line-height: 1.75rem;
        }

        .font-semibold {
            font-weight: 600;
        }

        .text-gray-700 {
            color: #374151;
        }

        .mb-4 {
            margin-bottom: 16px;
        }

        .block {
            display: block;
        }

        .text-sm {
            font-size: 0.875rem;
            line-height: 1.25rem;
        }

        .font-bold {
            font-weight: 700;
        }

        .appearance-none {
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
        }

        .border {
            border-width: 1px;
        }

        .rounded {
            border-radius: 6px;
        }

        .w-full {
            width: 100%;
        }

        .py-3 {
            padding-top: 8px;
            padding-bottom: 8px;
        }

        .px-4 {
            padding-left: 16px;
            padding-right: 16px;
        }

        .text-gray-700 {
            color: #374151;
        }

        .leading-tight {
            line-height: 1.5rem;
        }

        .focus\:outline-none:focus {
            outline: none;
        }

        .focus\:shadow-outline:focus {
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.15);
        }

        .bg-blue-500 {
            background-color: #3b82f6;
        }

        .hover\:bg-blue-700:hover {
            background-color: #2563eb;
        }

        .text-white {
            color: #ffffff;
        }

        .py-2 {
            padding-top: 0.5rem;
            padding-bottom: 0.5rem;
        }

        .focus\:outline-none:focus {
            outline: none;
        }

        .focus\:shadow-outline:focus {
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.15);
        }

        .space-y-2 > * + * {
            margin-top: 8px;
        }

        .text-blue-600 {
            color: #2563eb;
        }

        .text-center {
            text-align: center;
        }

        .text-2xl {
            font-size: 1.5rem;
            line-height: 2rem;
        }

        .md\:text-3xl {
            font-size: 1.875rem;
            line-height: 2.25rem;
        }

        .lg\:text-4xl {
            font-size: 2.25rem;
            line-height: 2.5rem;
        }

        .space-y-4 > * + * {
            margin-top: 1rem;
        }

        .items-center {
            align-items: center;
        }

        .justify-between {
            justify-content: space-between;
        }

        .text-gray-800 {
            color: #1f2937;
        }

        .text-sm {
            font-size: 0.875rem;
            line-height: 1.25rem;
        }

        .text-gray-600 {
            color: #4b5563;
        }

        .rounded-md {
            border-radius: 0.375rem;
        }

        .bg-gray-50 {
            background-color: #f9fafb;
        }

        .pt-2 {
            padding-top: 0.5rem;
        }

        .border-t {
            border-top-width: 1px;
        }

        .border-gray-200 {
            border-color: #e5e7eb;
        }

        .text-xs {
            font-size: 0.75rem;
            line-height: 1rem;
        }

        .text-gray-500 {
            color: #6b7280;
        }

        .mr-2 {
            margin-right: 0.5rem;
        }

        .reaction-button {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 6px 12px;
            border-radius: 6px;
            transition: background-color 0.2s;
            border: none;
            background-color: transparent;
            cursor: pointer;
        }

        .reaction-button:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }

        .text-red-500 {
            color: #dc2626;
        }

        .text-blue-500 {
            color: #3b82f6;
        }

        .text-yellow-500 {
            color: #d97706;
        }

        .self-start {
            align-self: flex-start;
        }

        .comment {
            display: flex;
            gap: 8px;
            padding: 8px;
            border-radius: 8px;
            background-color: #f0f0f0;
            margin-bottom: 4px;
        }

        .comment-section {
            margin-top: 1rem;
            display: none;
        }

        .comment-section.show {
            display: block;
        }

        .rounded-full {
            border-radius: 50%;
        }

        .h-8 {
            height: 2rem;
        }

        .w-8 {
            width: 2rem;
        }

        .bg-blue-500 {
            background-color: #3b82f6;
        }

        .text-white {
            color: #fff;
        }

        .flex {
            display: flex;
        }

        .items-center {
            align-items: center;
        }

        .justify-center {
            justify-content: center;
        }

        .h-6 {
            height: 1.5rem;
        }

        .w-6 {
            width: 1.5rem;
        }

        .bg-purple-500 {
            background-color: #8b5cf6;
        }

        .flex-1 {
            flex: 1 1 0%;
        }
        .main-content {
            margin-left: 0px; 
            padding: 20px;
            display: flex;
            flex-direction: column;
            min-height: calc(100vh - 40px);
            box-sizing: border-box;
            position: relative;
        }
       
        .back-button {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 8px 16px;
            border-radius: 6px;
            background-color: red;
            color: white;
            text-decoration: none;
            font-weight: 500;
            transition: background-color 0.2s;
            margin-bottom: 20px;
            border: 1px solid #d1d5db;
        }

        .back-button:hover {
            background-color: #d1d5db;
        }

    </style>
</head>
<body>
  <div class="sidebar">
    <div class="sidebar-top">
      <img src="admin-avatar.png" alt="admin" class="admin-image">
      <p style="font-size: 18px; font-weight: bold;">HUMAN RESOURCES 1</p>
    </div>
    <div class="sidebar-content">
      <ul class="sidebar-menu">
        <li><a href="dashboard.html">Dashboard</a></li>

        <li><a href="#" onclick="toggleSubMenu('Recruitment')">Recruitment</a></li>
        <ul id="Recruitment" style="display:none;">
          <li><a href="Jobposting.html">Job Posting</a></li>
          <li><a href="Sourcing.html">Sourcing Candidates</a></li>
          <li><a href="Create.html">Create Job Posting</a></li>
        </ul>

        <li><a href="#" onclick="toggleSubMenu('ApplicantManagement')">Applicant Management</a></li>
        <ul id="ApplicantManagement" style="display:none;">
          <li><a href="Application.html">Application Tracking</a></li>
          <li><a href="interviews.html">Interviews & Assessments</a></li>
          <li><a href="selection.html">Selection Offer</a></li>
        </ul>

        <li><a href="#" onclick="toggleSubMenu('NewHiredOnBoard')">New Hired On Board</a></li>
        <ul id="NewHiredOnBoard" style="display:none;">
          <li><a href="Documentation.html">Documentation</a></li>
          <li><a href="Orientation.html">Orientation & Training</a></li>
          <li><a href="Assignment.html">Role Assignment</a></li>
        </ul>

        <li><a href="#" onclick="toggleSubMenu('SocialRecognitionProgram')">Social Recognition Program</a></li>
        <ul id="SocialRecognitionProgram" style="display:none;">
          <li><a href="Acknowledgement.html">Acknowledging Achievements</a></li>
          <li><a href="Peer.html">Peer-to-peer recognition</a></li>
          <li><a href="Employee.html">Employee engagement programs</a></li>
        </ul>

        <li><a href="#" onclick="toggleSubMenu('Performancemanagement')">Performance management</a></li>
        <ul id="Performancemanagement" style="display:none;">
          <li><a href="Goal.html">Goal setting</a></li>
          <li><a href="Feedback.html">Feedback cycles</a></li>
          <li><a href="Review.html">Performance reviews</a></li>
        </ul>

        <li><a href="users.html">Users</a></li>
        <li><a href="settings.html">Settings</a></li>
      </ul>
    </div>

    <a href="login1.html" class="logout-link" onclick="return confirmLogout();">Log out</a>
  </div>
  
   <div class="main-content">
        <a href="admin.html" class="back-button">Back</a>
        <div class="container">
        <h1 class="text-2xl md:text-3xl lg:text-4xl font-semibold text-blue-600 text-center mb-6">Peer-to-Peer Recognition</h1>

        <div class="flex flex-col lg:flex-row gap-6">
            <div class="w-full lg:w-1/4">
                <div class="bg-white; rounded-lg shadow-md p-4 md:p-6 mb-6">
                    <h2 class="text-lg font-semibold text-gray-700 mb-4">Filter By</h2>
                    <div class="mb-4">
                        <label for="team" class="block text-gray-700 text-sm font-bold mb-2">Team</label>
                        <select id="team" class="shadow appearance-none border rounded w-full py-3 px-4 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
                            <option>All Teams</option>
                            <option>Engineering</option>
                            <option>Marketing</option>
                            <option>Sales</option>
                            <option>HR</option>
                        </select>
                    </div>
                    <div class="mb-4">
                        <label for="department" class="block text-gray-700 text-sm font-bold mb-2">Department</label>
                        <select id="department" class="shadow appearance-none border rounded w-full py-3 px-4 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
                            <option>All Departments</option>
                            <option>Product Development</option>
                            <option>Communications</option>
                            <option>Business Development</option>
                            <option>People Operations</option>
                        </select>
                    </div>
                    <div class="mb-4">
                        <label for="date" class="block text-gray-700 text-sm font-bold mb-2">Date</label>
                        <input type="date" id="date" class="shadow appearance-none border rounded w-full py-3 px-4 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
                    </div>
                    <div class="mb-4">
                        <label for="badge" class="block text-gray-700 text-sm font-bold mb-2">Badge</label>
                        <select id="badge" class="shadow appearance-none border rounded w-full py-3 px-4 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
                            <option>All Badges</option>
                            <option>Great Mentor</option>
                            <option>Team Hero</option>
                            <option>Excellent Communicator</option>
                            <option>Problem Solver</option>
                        </select>
                    </div>
                    <button id="filter-button" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline">
                        Apply Filters
                    </button>
                </div>
                <div class="bg-white rounded-lg shadow-md p-4 md:p-6">
                    <h2 class="text-lg font-semibold text-gray-700 mb-4">Top Recognized Employees</h2>
                    <ul id="leaderboard" class="space-y-2">
                    </ul>
                </div>
            </div>

            <div class="w-full lg:w-3/4">
                <button id="give-kudos-button" class="kudos-button text-white font-bold py-3 px-6 rounded focus:outline-none focus:shadow-outline mb-6">
                    Give Kudos
                </button>

                <div id="recognition-feed" class="space-y-4">
                </div>
            </div>
        </div>
    </div>

    <div id="give-kudos-modal" class="fixed z-10 inset-0 overflow-y-auto hidden">
        <div class="flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">
            <div class="fixed inset-0 transition-opacity" aria-hidden="true">
                <div class="absolute inset-0 bg-gray-500 opacity-75"></div>
            </div>
            <div class="inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full">
                <div class="bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4">
                    <div class="sm:flex sm:items-start">
                        <div class="mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left">
                            <h2 class="text-lg leading-6 font-medium text-gray-900" id="modal-title">
                                Give Kudos
                            </h2>
                            <form id="kudos-form" class="mt-4 space-y-4">
                                <div>
                                    <label for="recipient" class="block text-gray-700 text-sm font-bold mb-2">To:</label>
                                    <select id="recipient" required class="shadow appearance-none border rounded w-full py-3 px-4 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
                                        <option value="">Select Recipient</option>
                                    </select>
                                </div>
                                <div>
                                    <label for="badge-emoji" class="block text-gray-700 text-sm font-bold mb-2">Badge/Emoji:</label>
                                    <select id="badge-emoji" required class="shadow appearance-none border rounded w-full py-3 px-4 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
                                        <option value="">Select Badge/Emoji</option>
                                        <option value="🏅">🏅 Achievement</option>
                                        <option value="🤝">🤝 Teamwork</option>
                                        <option value="⭐">⭐ Excellence</option>
                                        <option value="💡">💡 Innovation</option>
                                        <option value="💖">💖 Appreciation</option>
                                    </select>
                                </div>
                                <div>
                                    <label for="message" class="block text-gray-700 text-sm font-bold mb-2">Message:</label>
                                    <textarea id="message" rows="5" maxlength="500" required class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"></textarea>
                                    <p id="char-count" class="text-gray-500 text-xs text-right">0/500</p>
                                </div>
                                <div>
                                    <label for="visibility" class="block text-gray-700 text-sm font-bold mb-2">Visibility:</label>
                                    <select id="visibility" class="shadow appearance-none border rounded w-full py-3 px-4 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
                                        <option value="public">Public (Show on Wall)</option>
                                        <option value="private">Private (Email Only)</option>
                                    </select>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
                <div class="bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse">
                    <button type="submit" class="w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm" onclick="document.getElementById('kudos-form').dispatchEvent(new Event('submit'))">
                        Give Kudos
                    </button>
                    <button type="button" class="mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm close-button">
                        Cancel
                    </button>
                </div>
            </div>
        </div>
    </div>
    <script>
function confirmLogout() {
  return confirm("Are you sure you want to log out?");
}

function toggleSubMenu(menuId) {
  var subMenu = document.getElementById(menuId);
  if (subMenu.style.display === "none") {
    subMenu.style.display = "block";
  } else {
    subMenu.style.display = "none";
  }
}

const employees = [
    { id: '1', name: 'Alice Smith', team: 'Engineering', department: 'Product Development' },
    { id: '2', name: 'Bob Johnson', team: 'Marketing', department: 'Communications' },
    { id: '3', name: 'Charlie Brown', team: 'Sales', department: 'Business Development' },
    { id: '4', name: 'Diana Miller', team: 'HR', department: 'People Operations' },
    { id: '5', name: 'Ethan Davis', team: 'Engineering', department: 'Product Development' },
    { id: '6', name: 'Fiona Green', team: 'Marketing', department: 'Communications' },
    { id: '7', name: 'George White', team: 'Sales', department: 'Business Development' },
    { id: '8', name: 'Hannah Black', team: 'HR', department: 'People Operations' },
    { id: '9', name: 'Ivy Taylor', team: 'Engineering', department: 'Product Development' },
    { id: '10', name: 'Jack Lewis', team: 'Marketing', department: 'Communications' },
];

const recognitionPosts = [
  {
    id: '101',
    sender: { id: '1', name: 'Alice Smith' },
    receiver: { id: '2', name: 'Bob Johnson' },
    badge: '⭐',
    message: 'For outstanding work on the Q3 campaign!',
    timestamp: '2025-07-28T10:00:00Z',
    visibility: 'public',
    comments: [
      { id: 'c1', sender: {id: '3', name: 'Charlie Brown'}, text: 'Great job, Bob!' },
      { id: 'c2', sender: {id: '4', name: 'Diana Miller'}, text: 'Well deserved!' },
    ],
    reactions: {
      'like': [{id: '5', name: 'Ethan Davis'}],
      'love': [{id: '6', name: 'Fiona Green'}],
      'celebrate': [{id: '7', name: 'George White'}]
    },
  },
  {
    id: '102',
    sender: { id: '3', name: 'Charlie Brown' },
    receiver: { id: '1', name: 'Alice Smith' },
    badge: '🏅',
    message: 'For leading the team to exceed sales targets.',
    timestamp: '2025-07-27T15:30:00Z',
    visibility: 'public',
    comments: [],
     reactions: {
      'like': [],
      'love': [],
      'celebrate': []
    },
  },
    {
    id: '103',
    sender: { id: '4', name: 'Diana Miller' },
    receiver: { id: '5', name: 'Ethan Davis' },
    badge: '🤝',
    message: 'Thank you for being a great team player.',
    timestamp: '2025-07-26T09:15:00Z',
    visibility: 'public',
    comments: [],
     reactions: {
      'like': [],
      'love': [],
      'celebrate': []
    },
  },
    {
    id: '104',
    sender: { id: '6', name: 'Fiona Green' },
    receiver: { id: '7', name: 'George White' },
    badge: '💡',
    message: 'For the innovative idea that improved our workflow.',
    timestamp: '2025-07-25T11:00:00Z',
    visibility: 'public',
    comments: [],
     reactions: {
      'like': [],
      'love': [],
      'celebrate': []
    },
  },
    {
    id: '105',
    sender: { id: '8', name: 'Hannah Black' },
    receiver: { id: '9', name: 'Ivy Taylor' },
    badge: '💖',
    message: 'Your positive attitude is appreciated.',
    timestamp: '2025-07-24T14:45:00Z',
    visibility: 'public',
    comments: [],
     reactions: {
      'like': [],
      'love': [],
      'celebrate': []
    },
  },
];

const loggedInUser = { id: '10', name: 'Jack Lewis' };

const kudosButton = document.getElementById('give-kudos-button');
const kudosModal = document.getElementById('give-kudos-modal');
const closeModalButtons = document.querySelectorAll('.close-button');
const kudosForm = document.getElementById('kudos-form');
const recipientSelect = document.getElementById('recipient');
const messageInput = document.getElementById('message');
const charCountDisplay = document.getElementById('char-count');
const recognitionFeed = document.getElementById('recognition-feed');
const teamFilter = document.getElementById('team');
const departmentFilter = document.getElementById('department');
const dateFilter = document.getElementById('date');
const badgeFilter = document.getElementById('badge');
const filterButton = document.getElementById('filter-button');
const leaderboardList = document.getElementById('leaderboard');


let isModalOpen = false;

function updateCharCount(text) {
    const count = text.length;
    charCountDisplay.textContent = `${count}/500`;
    charCountDisplay.style.color = count === 500 ? '#ff0000' : '#6b7280';
}

function openKudosModal() {
    if (!isModalOpen) {
        kudosModal.classList.add('show');
        isModalOpen = true;
        document.body.style.overflow = 'hidden';
    }
}

function closeKudosModal() {
    if (isModalOpen) {
        kudosModal.classList.remove('show');
        isModalOpen = false;
        document.body.style.overflow = 'auto';
    }
}

function populateRecipients() {
    recipientSelect.innerHTML = '<option value="">Select Recipient</option>';
    employees.forEach((employee) => {
        if (employee.id !== loggedInUser.id) {
            const option = document.createElement('option');
            option.value = employee.id;
            option.textContent = employee.name;
            recipientSelect.appendChild(option);
        }
    });
}

function getTopRecognizedEmployees() {
    const employeeRecognitionCount = {};
    recognitionPosts.forEach((post) => {
        const receiverId = post.receiver.id;
        employeeRecognitionCount[receiverId] =
            (employeeRecognitionCount[receiverId] || 0) + 1;
    });

    const sortedEmployeeIds = Object.keys(employeeRecognitionCount).sort(
        (a, b) => employeeRecognitionCount[b] - employeeRecognitionCount[a]
    );

    return sortedEmployeeIds.slice(0, 5).map((id) => {
        const employee = employees.find((e) => e.id === id);
        return {
            id: employee.id,
            name: employee.name,
            count: employeeRecognitionCount[id],
        };
    });
}

function renderLeaderboard() {
    leaderboardList.innerHTML = '';
    const topEmployees = getTopRecognizedEmployees();
    topEmployees.forEach((employee) => {
        const listItem = document.createElement('li');
        listItem.className = 'flex items-center justify-between text-gray-800 text-sm rounded-md bg-gray-50 pt-2 border-t border-gray-200';
        listItem.innerHTML = `<span class="font-bold">${employee.name}</span> <span class="text-gray-500 text-xs">${employee.count} Kudos</span>`;
        leaderboardList.appendChild(listItem);
    });
}

function renderRecognitionFeed(posts = recognitionPosts) {
    recognitionFeed.innerHTML = '';
    posts.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
    posts.forEach((post) => {
        const postElement = document.createElement('div');
        postElement.className =
            'bg-white rounded-lg shadow-md p-4 md:p-6 space-y-4';

        const senderName = post.sender.name;
        const receiverName = post.receiver.name;

        const postHeader = document.createElement('div');
        postHeader.className = 'flex items-center justify-between text-sm text-gray-600';
        postHeader.innerHTML = `
          <span class="font-semibold">From: ${senderName}</span>
          <span>To: ${receiverName}</span>
          <span class="text-gray-500">${new Date(post.timestamp).toLocaleDateString()}</span>
        `;

        const messageElement = document.createElement('p');
        messageElement.className = 'text-gray-800';
        messageElement.textContent = `${post.message}`;

        const badgeElement = document.createElement('div');
        badgeElement.className = 'text-2xl';
        badgeElement.textContent = post.badge;

        const reactionsElement = document.createElement('div');
        reactionsElement.className = 'flex items-center justify-start gap-4 pt-2 border-t border-gray-200';

      const reactionTypes = ['like', 'love', 'celebrate'];
        reactionTypes.forEach(type => {
            const count = post.reactions[type]?.length || 0;
            const userHasReacted = post.reactions[type]?.some(user => user.id === loggedInUser.id);
            const button = document.createElement('button');
            button.className = `reaction-button ${userHasReacted ? `text-${
                type === 'like' ? 'blue' :
                type === 'love' ? 'red' : 'yellow'
            }-500` : ''}`;
            button.textContent = `${
                type === 'like' ? '👍' :
                type === 'love' ? '❤️' : '🎉'
            } ${count}`;
            button.addEventListener('click', () => {
                handleReaction(post.id, type);
            });
            reactionsElement.appendChild(button);
        });

        const commentSection = document.createElement('div');
        commentSection.className = 'comment-section';

        const commentHeader = document.createElement('h4');
        commentHeader.textContent = 'Comments';
        commentSection.appendChild(commentHeader);

        post.comments.forEach(comment => {
            const commentDiv = document.createElement('div');
            commentDiv.className = 'comment';
            commentDiv.innerHTML = `<span class="font-semibold">${comment.sender.name}:</span> ${comment.text}`;
            commentSection.appendChild(commentDiv);
        });

        const addCommentForm = document.createElement('form');
        addCommentForm.addEventListener('submit', (event) => {
            event.preventDefault();
            const commentInput = event.target.querySelector('input');
            const commentText = commentInput.value.trim();
            if (commentText) {
                const newComment = {
                    id: `c${post.comments.length + 1}`,
                    sender: loggedInUser,
                    text: commentText
                };
                post.comments.push(newComment);
                renderRecognitionFeed();
                commentInput.value = '';
                commentSection.classList.add('show');
            }
        });

        const commentInputGroup = document.createElement('div');
        commentInputGroup.className = 'flex items-center gap-2';
        const commentInput = document.createElement('input');
        commentInput.type = 'text';
        commentInput.placeholder = 'Add a comment...';
        commentInput.className = 'flex-1 border rounded-md py-2 px-3 focus:outline-none focus:ring-2 focus:ring-blue-500';
        const commentButton = document.createElement('button');
        commentButton.type = 'submit';
        commentButton.textContent = 'Post';
        commentButton.className = 'bg-blue-500 hover:bg-blue-700 text-white rounded-md py-2 px-4 focus:outline-none focus:ring-2 focus:ring-blue-500';
        commentInputGroup.appendChild(commentInput);
        commentInputGroup.appendChild(commentButton);
        addCommentForm.appendChild(commentInputGroup);
        commentSection.appendChild(addCommentForm);

        const viewCommentsButton = document.createElement('button');
        viewCommentsButton.textContent = post.comments.length > 0 ? `View ${post.comments.length} Comment${post.comments.length !== 1 ? 's' : ''}`: 'View Comments';
        viewCommentsButton.className = 'text-blue-600 text-sm cursor-pointer self-start';
        viewCommentsButton.addEventListener('click', () => {
            commentSection.classList.toggle('show');
        });
        postElement.appendChild(postHeader);
        postElement.appendChild(badgeElement);
        postElement.appendChild(messageElement);
        postElement.appendChild(reactionsElement);
        postElement.appendChild(viewCommentsButton);
        postElement.appendChild(commentSection);
        recognitionFeed.appendChild(postElement);
    });
}
function handleReaction(postId, reactionType) {
    const post = recognitionPosts.find(p => p.id === postId);
    if (!post) return;

    const existingReaction = post.reactions[reactionType]?.find(user => user.id === loggedInUser.id);

    if (existingReaction) {
        // Remove the user's reaction
        post.reactions[reactionType] = post.reactions[reactionType].filter(user => user.id !== loggedInUser.id);
    } else {
        // Add the user's reaction
        if (!post.reactions[reactionType]) {
            post.reactions[reactionType] = [];
        }
        post.reactions[reactionType].push(loggedInUser);
    }
    renderRecognitionFeed();
}

kudosButton.addEventListener('click', openKudosModal);
closeModalButtons.forEach(button => {
    button.addEventListener('click', closeKudosModal);
});

window.addEventListener('click', (event) => {
    if (event.target === kudosModal) {
        closeKudosModal();
    }
});

messageInput.addEventListener('input', (event) => {
    updateCharCount(event.target.value);
});

kudosForm.addEventListener('submit', (event) => {
    event.preventDefault();

    const recipientId = recipientSelect.value;
    const badge = document.getElementById('badge-emoji').value;
    const message = messageInput.value.trim();
    const visibility = document.getElementById('visibility').value;

    if (recipientId && message) {
        const recipient = employees.find((e) => e.id === recipientId);
         const newPost = {
            id: String(Date.now()),
            sender: loggedInUser,
            receiver: recipient,
            badge,
            message,
            timestamp: new Date().toISOString(),
            visibility,
             comments: [],
              reactions: {
              'like': [],
              'love': [],
              'celebrate': []
            },
        };

        recognitionPosts.push(newPost);
        renderRecognitionFeed();

        if (visibility === 'private') {
            console.log(`Sending private recognition email to ${recipient.name}: ${message}`);
        }
        closeKudosModal();
    } else {
        alert('Please select a recipient and enter a message.');
    }
});

filterButton.addEventListener('click', () => {
    const selectedTeam = teamFilter.value;
    const selectedDepartment = departmentFilter.value;
    const selectedDate = dateFilter.value;
    const selectedBadge = badgeFilter.value;

    const filteredPosts = recognitionPosts.filter(post => {
        const postDate = new Date(post.timestamp).toISOString().split('T')[0];

        const teamMatch = !selectedTeam || employees.find(e => e.id === post.sender.id).team === selectedTeam || employees.find(e => e.id === post.receiver.id).team === selectedTeam;
        const departmentMatch = !selectedDepartment || employees.find(e => e.id === post.sender.id).department === selectedDepartment || employees.find(e => e.id === post.receiver.id).department === selectedDepartment;
        const dateMatch = !selectedDate || postDate === selectedDate;
        const badgeMatch = !selectedBadge || post.badge === selectedBadge;

        return teamMatch && departmentMatch && dateMatch && badgeMatch;
    });
    renderRecognitionFeed(filteredPosts);
});

populateRecipients();
renderLeaderboard();
renderRecognitionFeed();
</script>
</body>
</html>
